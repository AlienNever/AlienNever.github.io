<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alien</title>
  <subtitle>有梦不觉人生寒,有爱不觉天涯远</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://aliennever.github.io/"/>
  <updated>2018-10-25T08:53:04.598Z</updated>
  <id>https://aliennever.github.io/</id>
  
  <author>
    <name>LG</name>
    <email>76229074@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>11gOCM-Skillset2</title>
    <link href="https://aliennever.github.io/2018/09/05/06-20180827OCM%20Skillset2/"/>
    <id>https://aliennever.github.io/2018/09/05/06-20180827OCM Skillset2/</id>
    <published>2018-09-05T04:00:00.000Z</published>
    <updated>2018-10-25T08:53:04.598Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Skillset-2"><a href="#Skillset-2" class="headerlink" title="Skillset 2"></a>Skillset 2</h1><h2 id="TASKS"><a href="#TASKS" class="headerlink" title="TASKS:"></a>TASKS:</h2><ol>
<li><strong>Register the PROD1、PROD2 database with the catalog on prod4</strong><br> export ORACLE_SID=PROD4<br> sqlplus / as sysdba<br> create tablespace rctbs datafile ‘/u01/app/oracle/oradata/PROD4/rctbs01.dbf’ size 50m autoextend on;<br> create user rcowner identified by rc default tablespace rctbs quota unlimited on rctbs;<br> grant recovery_catalog_owner to rcowner;<br> rman  target / catalog rcowner/rc<br> create catalog;<br> export ORACLE_SID=PROD1<br> rman target / catalog rcowner/rc@PROD4<br> register database;<br> report schema;<br> export ORACLE_SID=PROD2<br> rman target / catalog rcowner/rc@PROD4<br> register database;<br> report schema;</li>
<li><strong>Use Recovery Manager to Perform Database backups</strong><br>2.1 Perform a tablespace backup for database PROD1 using fast recovery area<br>2.1.1 backup EXAMPLE tablespace<br>2.1.2 section size 30M<br> export ORACLE_SID=PROD1<br> sqlplus / as sysdba<br> alter system set db_recovery_file_dest=’/u01/app/oracle/fast_recovery_area’ scope=spfile;<br> alter system set db_recovery_file_dest_size=2G;<br> select ARCHIVER from v$instance;<br> shut immediate<br> startup mount<br> alter database archivelog;<br> alter database open;<br> rman target /<br> RMAN&gt;  backup tablespace example section size 30m;<br>2.2 Perform a backup for database PROD1<br>2.2.1 Backup whole database<br>2.2.2 Backup TAG is “Q107”<br>2.2.3 Backup directory to “/home/oracle/files”(Implied)<br>2.2.4 Backup keep long time<br> mkdir -p /home/oracle/files<br> rman target / catalog rcowner/rc@PROD4<br> backup database plus archivelog format ‘/home/oracle/files/prod1<em>full</em>%u.bak’ tag ‘Q107’ keep forever;<br>2.3 Perform a backup for database PROD2 using fast recovery area<br> export ORACLE_SID=PROD2<br> sqlplus / as sysdba<br> show parameter recovery<br> select archiver from v$instance;<br> shut immediate<br> startup mount<br> alter database archivelog;<br> alter database open;<br> rman target / catalog rcowner/rc@PROD4<br> backup database;<br> sqlplus / as sysdba<br> alter system archive log current;<br>2.4 Reduce Overheads of Fast Incremental Backups on the PROD1 database<br> alter database enable block change tracking using file ‘/home/oracle/files/bct.f’;</li>
<li><strong>Flashback Database</strong><br>3.1 Turn on Flashback Database for PROD1 database<br>3.1.1 Configure a flash recovery area of 4GB<br>3.1.2 Put your flash recovery area in /home/oracle/flash (you may have to create this diretory)<br> mkdir -p /home/oracle/flash<br> alter system set db_recovery_file_dest=’/home/oracle/flash’ scope=spfile;<br> alter system set db_recovery_file_dest_size=4g;<br> alter database flashback on;<br> shutdown immediate<br> startup<br>3.2 Leave your databases open for review.<br>3.3 Execute a script (/home/oracle/scripts/s2_1.sql), flash backup to step of insert opration finish.<br> alter user hr identified by hr account unlock;<br> @/home/oracle/scripts/s2_1.sql<br> alter table hr.regions enable row movement;<br> alter table hr.locations enable row movement;<br> select versions_startscn,versions_endscn,versions_operation,region_id,region_name from hr.regions versions between timestamp to_timestamp(‘2018-10-25 16:30:00’,’YYYY-MM-DD HH24:MI:SS’) and to_timestamp(‘2018-10-25 16:38:00’,’YYYY-MM-DD HH24:MI:SS’);<br> flashback table hr.regions,hr.countries,hr.locations to scn 945152;<br> select * from hr.regions;</li>
</ol>
]]></content>
    
    <summary type="html">
    
      ocm11g认证考试
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="oracle" scheme="https://aliennever.github.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>11gOCM-Skillset1</title>
    <link href="https://aliennever.github.io/2018/07/03/05-20180710OCM%20Skillset1/"/>
    <id>https://aliennever.github.io/2018/07/03/05-20180710OCM Skillset1/</id>
    <published>2018-07-03T04:00:00.000Z</published>
    <updated>2018-10-25T08:53:51.071Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Skillset-1"><a href="#Skillset-1" class="headerlink" title="Skillset 1"></a>Skillset 1</h1><h2 id="NOTE"><a href="#NOTE" class="headerlink" title="NOTE:"></a>NOTE:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Database Server and Management Server, user/pwd: oracle/ocm123</div><div class="line">if need root,use sudo </div><div class="line">oracle doc: /stage/.../English/index.htm</div><div class="line">The root directory must be kept free space 15%</div></pre></td></tr></table></figure>
<h2 id="TASKS"><a href="#TASKS" class="headerlink" title="TASKS:"></a>TASKS:</h2><ol>
<li><strong>Create Database</strong><br>1.1 Create a database the SID name is PROD3 at Management Server.<br>设置环境变量：<br> vi .bash_profile<br> export ORACLE_BASE=/u01/app/oracle<br> export ORACLE_HOME=$ORACLE_BASE/product/11.2.0/db_1<br> export PATH=$ORACLE_HOME/bin:/sbin:/user/sbin:$PATH<br> source .bash_profile<br>创建所需目录:<br> cd $ORACLE_BASE<br> mkdir -p admin/PROD3/adump<br> mkdir -p oradata/PROD3<br>生成密码文件：<br> cd $ORACLE_HOME/dbs<br> orapwd file=orapwPROD3 password=oracle entries=30<br>创建pfile参数文件：<br> cat init.ora |grep -v ^#|grep -v ^$ &gt; initPROD3.ora<br> vi initPROD3.ora <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">db_name=&apos;PROD3&apos;</div><div class="line">memory_target=1G</div><div class="line">processes = 150</div><div class="line">audit_file_dest=&apos;/u01/app/oracle/admin/PROD3/adump&apos;</div><div class="line">audit_trail =&apos;db&apos;</div><div class="line">db_block_size=8192</div><div class="line">db_domain=&apos;&apos;</div><div class="line">db_recovery_file_dest=&apos;/u01/app/oracle/fast_recovery_area&apos;</div><div class="line">db_recovery_file_dest_size=2G</div><div class="line">diagnostic_dest=&apos;/u01/app/oracle&apos;</div><div class="line">dispatchers=&apos;(PROTOCOL=TCP)&apos;</div><div class="line">open_cursors=300</div><div class="line">remote_login_passwordfile=&apos;EXCLUSIVE&apos;</div><div class="line">undo_tablespace=&apos;UNDOTBS1&apos;</div><div class="line">control_files = (/u01/app/oracle/oradata/PROD3/control01.ctl, /u01/app/oracle/oradata/PROD3/control02.ctl)</div><div class="line">compatible =&apos;11.2.0&apos;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>生成spfile参数文件：<br>    export ORACLE_SID=PROD3<br>    sqlplus / as sysdba<br>    SQL&gt; create spfile from pfile;<br>    SQL&gt; startup nomount;<br>执行创建数据库语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">CREATE DATABASE PROD3</div><div class="line">   USER SYS IDENTIFIED BY oracle</div><div class="line">   USER SYSTEM IDENTIFIED BY oracle</div><div class="line">   LOGFILE GROUP 1 (&apos;/u01/app/oracle/oradata/PROD3/redo01.log&apos;) SIZE 100M BLOCKSIZE 512,</div><div class="line">           GROUP 2 (&apos;/u01/app/oracle/oradata/PROD3/redo02.log&apos;) SIZE 100M BLOCKSIZE 512,</div><div class="line">           GROUP 3 (&apos;/u01/app/oracle/oradata/PROD3/redo03.log&apos;) SIZE 100M BLOCKSIZE 512</div><div class="line">   MAXLOGFILES 5</div><div class="line">   MAXLOGMEMBERS 5</div><div class="line">   MAXLOGHISTORY 1</div><div class="line">   MAXDATAFILES 100</div><div class="line">   CHARACTER SET AL32UTF8</div><div class="line">   NATIONAL CHARACTER SET AL16UTF16</div><div class="line">   EXTENT MANAGEMENT LOCAL</div><div class="line">   DATAFILE &apos;/u01/app/oracle/oradata/PROD3/system01.dbf&apos; SIZE 325M REUSE</div><div class="line">   SYSAUX DATAFILE &apos;/u01/app/oracle/oradata/PROD3/sysaux01.dbf&apos; SIZE 325M REUSE</div><div class="line">   DEFAULT TABLESPACE users</div><div class="line">      DATAFILE &apos;/u01/app/oracle/oradata/PROD3/users01.dbf&apos;</div><div class="line">      SIZE 100M REUSE AUTOEXTEND ON MAXSIZE UNLIMITED</div><div class="line">   DEFAULT TEMPORARY TABLESPACE temptbs1</div><div class="line">      TEMPFILE &apos;/u01/app/oracle/oradata/PROD3/temp01.dbf&apos;</div><div class="line">      SIZE 20M REUSE</div><div class="line">   UNDO TABLESPACE undotbs1</div><div class="line">      DATAFILE &apos;/u01/app/oracle/oradata/PROD3/undotbs1.dbf&apos;</div><div class="line">      SIZE 200M REUSE AUTOEXTEND ON MAXSIZE UNLIMITED;</div></pre></td></tr></table></figure></p>
<pre><code>NOTE：UNDO TABLESPACE表空间名要与参数文件中对应
</code></pre><p>执行catalog.sql和catproc.sql脚本:<br>    SQL&gt;  @?/rdbms/admin/catalog.sql<br>    SQL&gt;  @?/rdbms/admin/catproc.sql</p>
<ol>
<li><strong>Undo Management</strong><br>2.1 Setup automatic undo management in the PROD1 database to support the following requirements:<br>2.1.1 Avoid ORA-01555 Snapshot too old errors for queries running up to 90 minutes on average.<br> alter system set undo_retention=5400;<br>2.1.2 The number or concurrent OLTP users will be approximately 120 during normal business hours.<br> alter system set processes=140 scope=spfile;<br>2.1.3 The number or concurrent batch processes that will run in the evenings and weekends will approximately 12 to 15.<br> alter system set job_queue_processes=15;</li>
<li><p><strong>Server-sid Network Configuration</strong>（要求把默认和非默认的动态和静态全部配置）<br>3.1 Create a listener using the default listener name.<br>3.2 The TCP/IP protocol will be used for all connections,Use the machine name (not the IP address) for host.<br>3.3 This listener will listen on the default port<br>3.4 Databases will be serviced by this listener.<br>3.5 Add a second listener,named LSNR2,which will listen on port 1526.<br>3.6 Set up the PROD1 instance to automatically register with the LSNR2.<br>3.7 Start both listeners.<br> vi $ORACLE_HOME/network/admin/listener.ora</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">LISTENER =</div><div class="line">  (DESCRIPTION_LIST =</div><div class="line">    (DESCRIPTION =</div><div class="line">      (ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p1)(PORT = 1521))</div><div class="line">    )</div><div class="line">  )</div><div class="line">SID_LIST_LISTENER=</div><div class="line">  (SID_LIST=</div><div class="line">    (SID_DESC=</div><div class="line">      (GLOBAL_DBNAME=PROD1.us.example.com)</div><div class="line">      (ORACLE_HOME=/u01/app/oracle/product/11.2.0/dbhome_1)</div><div class="line">      (SID_NAME=PROD1)))</div><div class="line"></div><div class="line">LSNR2 =</div><div class="line">  (DESCRIPTION_LIST =</div><div class="line">    (DESCRIPTION =</div><div class="line">      (ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p1)(PORT = 1526))</div><div class="line">    )</div><div class="line">  )</div><div class="line">SID_LIST_LSNR2=</div><div class="line">  (SID_LIST=</div><div class="line">    (SID_DESC=</div><div class="line">      (GLOBAL_DBNAME=PROD1.us.example.com)</div><div class="line">      (ORACLE_HOME=/u01/app/oracle/product/11.2.0/dbhome_1)</div><div class="line">      (SID_NAME=PROD1)))</div><div class="line">ADR_BASE_LISTENER =/u01/app/oracle/product/11.2.0/dbhome_1</div></pre></td></tr></table></figure>
<p> lsnrctl start<br> lsnrctl start LSNR2<br> alter system set local_listener=’edbjr2p1:1521’,’edbjr2p1:1526’;<br> alter system register;</p>
</li>
<li><strong>Shared Server Configuration</strong><br>4.1 Configure the PROD1 database to support up to 300 sessions,reserving 100 for dedicated connections.<br> alter system set sessions=300 scope=spfile;<br> alter system set shared_server_sessions=200;<br>4.2 Configure the PROD1 database to support:<br>4.2.1 Dispatchers tcp 3<br> alter system set DISPATCHERS = ‘(PROTOCOL=TCP)(DISPATCHERS=3)’;<br>4.2.2 Maximum of 10 dispatchers<br> alter system set max_dispatchers=10;<br>4.3 Configure the PROD1 database to support:<br>4.3.1 Minimum of 10 shared server processes.<br> alter system set shared_servers=10;<br>4.3.2 Maximum of 30 shared server processes.<br> alter system set max_shared_servers=30;</li>
<li><p><strong>Client-side Network configuration</strong>（注意加上SERVER=DEDICATED）<br>5.1 Create the client-side network configuration files Providing connect descriptors to your databases using local naming and easy connect methods:<br>5.1.1 The prod1 alias should connect to the PROD1 instance using the default listener and always use a dedicated server connection.<br>5.1.2 The prod2 alias should connect to the PROD2 instance using the default listener and always use a dedicated server connection.<br>5.1.3 The prod3 alias should connect to the PROD3 instance using the default listener and always use a dedicated server connection.<br>5.1.4 The prod4 alias should connect to the PROD4 instance using the default listener and always use a dedicated server connection.<br>5.1.5 The EMREP alias should connect to the EMREP instance using the default listener and always use a dedicated server connection.<br>5.1.6 The PROD1_S alias should connect to the PROD1 instance using the LSNR2 listener and use a shared server connection.<br>5.1.7 The RACDB alias using host cluster01-scan.example.com should connect to the RAC and use a dedicated server connection.<br> vi $ORACLE_HOME/network/admin/tnsnames.ora</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">PROD1 =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p1)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = PROD1)))</div><div class="line">PROD2 =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p1)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = PROD2)))</div><div class="line">PROD3 =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p2)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = PROD3)))</div><div class="line">PROD4 =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p2)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = PROD4)))</div><div class="line">PROD1_S =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p1)(PORT = 1526)))</div><div class="line">    (CONNECT_DATA =(SERVER = SHARED)(SERVICE_NAME = PROD1)))</div><div class="line">EMREP =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = edbjr2p2)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = EMREP)))</div><div class="line">RACDB =</div><div class="line">  (DESCRIPTION =</div><div class="line">    (ADDRESS_LIST =(ADDRESS = (PROTOCOL = TCP)(HOST = cluster01-scan.example.com)(PORT = 1521)))</div><div class="line">    (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = RACDB)))</div></pre></td></tr></table></figure>
</li>
<li><p><strong>Tablespace Creation and Configuration</strong>  (PROD1)<br>Note: tablespaces must be named as specified in each task to receive credit.<br>6.1 Create a temporary tablespace group that contains two temporary tablespaces to support batch processing,the creation of large indexes and analyzing tables,Use the following specifications:<br>6.1.1 Temporary tablespace group named TEMP_GRP containing temporary tablespaces TEMP1 and TEMP2.<br>6.1.2 Make TEMP_GRP the default temporary tablespace for all new users.<br> create temporary tablespace TEMP1 tempfile ‘/u01/app/oracle/oradata/PROD1/temp1.dbf’ size 50m tablespace group TEMP_GRP;<br> create temporary tablespace TEMP2 tempfile ‘/u01/app/oracle/oradata/PROD1/temp2.dbf’ size 50m tablespace group TEMP_GRP;<br> alter database default temporary tablespace TEMP_GRP;<br> select * from DATABASE_PROPERTIES;<br> select name from v$tablespace;<br>6.2 Create a permanent tablespace to store sample test data. Use the following specifications:<br>6.2.1 Tablespace name of EXAMPLE.<br>6.2.2 Initial datafile size of 500MB with the file expected to grow to 2GB.<br>6.2.3 Initial extent size of 1MB.<br>6.2.4 next extent size of 1MB.<br>6.2.5 segment space management freelist<br> create  tablespace EXAMPLE1 datafile ‘/u01/app/oracle/oradata/PROD1/example.dbf’ size 500m autoextend on next 1m maxsize 2g extent management local uniform size 1m segment space management manual;<br> select tablespace_name,next_extent,initial_extent from dba_tablespaces;<br>6.3 Create a permanent tablespace to store indexes,Use the following specifications:<br>6.3.1 Tablespace name of INDX<br>6.3.2 File size of 40MB<br> create tablespace INDX datafile ‘/u01/app/oracle/oradata/PROD1/indx.dbf’ size 40m autoextend on;<br>6.4 Create a permanent tablespace to store data collected from the various Oracle tools. Use the following Specification:<br>6.4.1 Tablespace name of TOOLS.<br>6.4.2 File size of 10MB.<br>6.4.3 Initial extent size of 4MB.<br>6.4.4 Next extent size of 4MB.<br> create tablespace TOOLS datafile ‘/u01/app/oracle/oradata/PROD1/tools.dbf’ size 10m autoextend on next 4m extent management local uniform size 4m;<br>6.5 Create a permanent tablespace to store sample test data. Use the following specification:<br>6.5.1 Tablespace name of TEST.<br>6.5.2 Initial datafile size of 400MB with the file expected to grow to 4TB.<br>6.5.3 Initial extent size of 10MB.<br>6.5.4 Next extent size of 10MB.<br> create bigfile tablespace TEST datafile ‘/u01/app/oracle/oradata/PROD1/test.dbf’ size 400m autoextend on next 10m maxsize 4t extent management local uniform size 10m;<br>6.6 Create and manage database configuration files. Triplex the controlfile to minimize recovery in case of disk drive failure.<br> show parameter control<br> alter system set control_files=’/u01/app/oracle/oradata/PROD1/control01.ctl’,’/u01/app/oracle/oradata/PROD1/control02.ctl’,’/u01/app/oracle/oradata/disk/PROD1/control03.ctl’ scope=spfile;<br> shut immediate<br> mkdir -p $ORACLE_BASE/oradata/disk/PROD1<br> cp $ORACLE_BASE/oradata/PROD1/control01.ctl  $ORACLE_BASE/oradata/disk/PROD1/control03.ctl<br> startup<br> show parameter control</p>
</li>
<li><strong>Schema statistics and Parameter File Configuration</strong><br>7.1 Compute statistics for the HR schemas in the database with cost based optimization.<br> EXEC DBMS_STATS.GATHER_SCHEMA_STATS(ownname=&gt;’hr’)<br>7.2 Investigate the parameter file for reasonable sizes for each parameter listed. Add additional parameters as you deem necessary to support an PL/SQL file I/O optimal database environment.<br> Add the following OS directory:’/home/oracle’,’/home/oracle/temp’,’/home/oracle/scripts’.<br> mkdir -p /home/oracle/scripts<br> alter system set utl_file_dir=’/home/oracle/‘,’/home/oracle/temp’,’/home/oracle/scripts’ scope=spfile;</li>
<li><strong>Backup the database to prepare for complete recovery under all circumstances</strong><br> export ORACLE_SID=PROD1<br> shut immediate<br> export ORACLE_SID=PROD2<br> shut immediate<br> tar -czvf PROD1.tar.gz PROD1<br> tar -xzvf PROD2.tar.gz PROD2</li>
<li><strong>Create and Manage a tablespace that uses NFS mounted file system file</strong>（需要加NFS参数，sudo /sbin/service NFS restart 打开DNFS驱动）<br>9.1 Create Database Server Directory /u02/oradata/prod1,Mapping to Management Server NFS,NFS Server network Path: /vol/oradata<br> mkdir -p  /u02/oradata/prod1<br> vi $ORACLE_HOME/dbs/oranfstab<pre><code>server: edbjr2p2
path: 192.168.233.129
export: /vol/oradata
mount: /u02/oradata/prod1
</code></pre> cd $ORACLE_HOME/rdbms/lib/<br> make -f ins_rdbms.mk dnfs_on<br> cd $ORACLE_HOME/lib<br> ls <em>odm</em><br> mv libodm11.so libodm11.so.bak<br> ln -s libnfsodm11.so libodm11.so<br>9.2 Create a tablespace named test_tbs on NFS and check it worked.<br> create tablespace test_tbs datafile ‘/u02/oradata/prod1/dnfs01.dbf’ size 5m autoextend off;<br> select <em> from v$dnfs_servers;<br> select </em> from v$dnfs_files;<br> select * from v$dnfs_channels;</li>
<li><strong>Use Opatch to install patch on PROD4</strong><br>10.1 Apply patch on PROD4<br>export PATH=$PATH:/u01/app/oracle/product/11.2.0/db_1/OPatch<br>unzip p12834800_112030_LINUX.zip<br>opatch lsinventory<br>opatch apply  online -connectString PROD4:sys:oracle</li>
<li><strong>Use Grid Infrastructure to manage oracle databases and other resources</strong><br>（ 测试环境没装全restart cd /u01/app/11.2.0/grid/crs/install 执行: sudo ./roothas.pl）<br>11.1 Register PROD4,EMREP to Grid Infrastructure<br>11.2 Register ASM,Listener to Grid Infrastructure<br>cd /u01/app/11.2.0/grid/bin<br>./crs_stat -t<br>./crsctl start has<br>./srvctl add database -d PROD4 -o $ORACLE_HOME<br>./srvctl add database -d EMREP -o $ORACLE_HOME<br>lsnrctl stop<br>./srvctl add listener<br>./srvctl add asm<br>./crs_stat -t<br>./srvctl start database -d prod4<br>./srvctl start database -d emrep<br>./srvctl start asm<br>./srvctl start listener<br>./crs_stat -t<br>11.3 Create ASM diskgroup: DATA use ASMDISK1-4,normal; FRA use ASMDISK5-8,extermal.<br>cd /u01/app/11.2.0/grid/bin/<br>./asmca<br>/dev/oracleasm/disks/*</li>
<li><strong>Use Enterprise Manager Configuration Assistant(EMCA) utility (ImplSkillsetIEd subject)</strong><br>alter user DBSNMP identified by oracle account unlock;<br>alter user SYSMAN identified by oracle account unlock;<br>emca -config dbcontrol db -repos recreate<br>emctl status dbconsole<br>emctl stop dbconsole<br>emctl start dbconsole<br>cat $ORACLE_HOME/install/portlist.ini<br><a href="https://localhost:1158/em/" target="_blank" rel="external">https://localhost:1158/em/</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      ocm11g认证考试
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="oracle" scheme="https://aliennever.github.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>Weblogic安装补丁</title>
    <link href="https://aliennever.github.io/2018/04/20/04-20180420/"/>
    <id>https://aliennever.github.io/2018/04/20/04-20180420/</id>
    <published>2018-04-20T04:00:00.000Z</published>
    <updated>2018-09-05T02:13:05.221Z</updated>
    
    <content type="html"><![CDATA[<ol>
<li>停止打PSU补丁的服务器上的所有weblogic服务</li>
<li><p>查看当前weblogic是打过PSU补丁：</p>
<ul>
<li>进入D:\Oracle\Middleware\wlserver_10.3\server\bin目录：</li>
<li>执行setWLSEnv.cmd(Linux下执行setWLSEnv.sh，设置环境变量)</li>
<li>执行java weblogic.version:<figure class="highlight plain"><figcaption><span>weblogic.version</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">WebLogic Server 10.3.6.0.180417 PSU Patch for BUG27395085 THU FEB 21 18:34:42 IS T 2018</div><div class="line"></div><div class="line">WebLogic Server 10.3.6.0  Tue Nov 15 08:52:36 PST 2011 1441050</div><div class="line"></div><div class="line">Use &apos;weblogic.version -verbose&apos; to get subsystem information</div><div class="line"></div><div class="line">Use &apos;weblogic.utils.Versions&apos; to get version information for all modules</div></pre></td></tr></table></figure>
</li>
</ul>
<p>若没打补丁则第一部分只有最后一行，上面可见已打过PSU补丁</p>
<ul>
<li>查看详细信息，可看到已达补丁ID<br>D:\Oracle\Middleware\utils\bsu&gt;bsu.cmd -prod_dir=D:\Oracle\Middleware\wlserver_10.3 -status=applied -verbose -view<br>linux:<br>./bsu.sh -prod_dir=/home/weblogic/Oracle/Middleware/wlserver_10.3 -status=applied -verbose -view<figure class="highlight plain"><figcaption><span>-prod_dir=D:\Oracle\Middleware\wlserver_10.3 -status=applied -verbose -view</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"> 四月 20, 2018 11:30:36 上午 java.util.prefs.WindowsPreferences &lt;init&gt;</div><div class="line"> WARNING: Could not open/create prefs root node Software\JavaSoft\Prefs at root 0</div><div class="line"> x80000002. Windows RegCreateKeyEx(...) returned error code 5.</div><div class="line"> ProductName:       WebLogic Server</div><div class="line"> ProductVersion:    10.3 MP6</div><div class="line"> Components:        </div><div class="line">               WebLogic Server/Core Application Server,WebLogic Server/Admi</div><div class="line">               nistration Console,WebLogic Server/Configuration Wizard and</div><div class="line">               Upgrade Framework,WebLogic Server/Web 2.0 HTTP Pub-Sub Serve</div><div class="line">               r,WebLogic Server/WebLogic SCA,WebLogic Server/WebLogic JDBC</div><div class="line">                Drivers,WebLogic Server/Third Party JDBC Drivers,WebLogic S</div><div class="line">               erver/WebLogic Server Clients,WebLogic Server/WebLogic Web S</div><div class="line">               erver Plugins,WebLogic Server/UDDI and Xquery Support,WebLog</div><div class="line">               ic Server/Evaluation Database,WebLogic Server/Workshop Code</div><div class="line">               Completion Support</div><div class="line">BEAHome:           D:\Oracle\Middleware</div><div class="line">ProductHome:       D:\Oracle\Middleware\wlserver_10.3</div><div class="line">PatchSystemDir:    D:\Oracle\Middleware\utils\bsu</div><div class="line">PatchDir:          D:\Oracle\Middleware\patch_wls1036</div><div class="line">Profile:           Default</div><div class="line">DownloadDir:       D:\Oracle\Middleware\utils\bsu\cache_dir</div><div class="line">JavaVersion:       1.6.0_29</div><div class="line">JavaVendor:        Sun</div><div class="line"></div><div class="line"></div><div class="line">Patch ID:          GFWX</div><div class="line">PatchContainer:    GFWX.jar</div><div class="line">Checksum:          -2141599595</div><div class="line">Severity:          optional</div><div class="line">Category:          General</div><div class="line">CR/BUG:            27395085</div><div class="line">Restart:           true</div><div class="line">Description:       WLS PATCH SET UPDATE 10.3.6.0.180417</div><div class="line">WLS PATCH SET UPDATE 10.3.6.0.180417</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>卸载已打过的PSU补丁，如没有打过PSU则忽略该步骤：</p>
<ul>
<li>D:\Oracle\Middleware\utils\bsu&gt;bsr.cmd -remove -patchlist=ZLNA -prod_dir=D:\Oracle\Middleware\wlserver_10.3</li>
</ul>
</li>
<li>官网下载最新的PSU，查看weblogic的安装目录D:\Oracle\Middleware\utils\bsu是否有cache_dir目录，无则新建目录cache_dir<br>将下载的PSU解压到cache_dir中</li>
<li>修改bsu.cmd(linux下为bsu.sh)的内存大小，建议为1g，默认不修改会报错无法执行PSU脚本<br>MEM_ARGS=-Xms1024m -Xmx1024m</li>
<li><p>进入D:\Oracle\Middleware\utils\bsu目录下执行操作<br>D:\Oracle\Middleware\utils\bsujava -jar patch-client.jar -install -patch_download_dir=D:\Oracle\Middleware\utils\bsu\cache_dir -patchlist=GFWX(cache_dir中jar包名) -prod_dir=D:\Oracle\Middleware\wlserver_10.3<br>Linux：<br>./bsu.sh -install -patch_download_dir=/home/weblogic/Oracle/Middleware/utils/bsu/cache_dir -patchlist=GFWX -prod_dir=/home/weblogic/Oracle/Middleware/wlserver_10.3</p>
 <figure class="highlight plain"><figcaption><span>for conflicts..</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">No conflict(s) detected</div><div class="line">Installing Patch ID: GFWX..</div><div class="line">Result: Success</div></pre></td></tr></table></figure>
</li>
<li><p>启动weblogic服务验证</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      weblogic学习
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="weblogic" scheme="https://aliennever.github.io/tags/weblogic/"/>
    
  </entry>
  
  <entry>
    <title>Oracle11g最小静默安装</title>
    <link href="https://aliennever.github.io/2018/03/05/03-20180305/"/>
    <id>https://aliennever.github.io/2018/03/05/03-20180305/</id>
    <published>2018-03-05T04:00:00.000Z</published>
    <updated>2018-03-12T00:50:46.290Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h1><hr>
<ol>
<li>软件环境：<ul>
<li>VM虚拟机：redhat Linux </li>
<li>oracle11g安装包</li>
<li>单机环境需要准备所需依赖包packages</li>
</ul>
</li>
<li>单机环境安装net-tools和unzip：<ul>
<li>配置本地yum源<ol>
<li>打开VMware,在CD/DVD设置选项中，将Redhat7镜像文件放入CD/DVD中</li>
<li>将虚拟光驱挂载到 /mnt 文件夹下 （确保虚拟光驱处于链接状态）<code>mount /dev/sr0 /mnt</code></li>
<li>/mnt/Packages下安装net-tools和unzip包 <code>rpm -ivh net-tools</code></li>
</ol>
</li>
</ul>
</li>
<li><p>若修改主机名则在在/etc/hosts文件中添加主机名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vi /etc/sysconfig/network</div><div class="line">HOSTNAME=Alien</div><div class="line">vi /etc/hosts</div><div class="line">127.0.0.1      localhost.localdomain localhost linuxhostname Alien</div></pre></td></tr></table></figure>
</li>
<li><p>修改内核参数文件/etc/sysctl.conf:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">fs.aio-max-nr = 1048576</div><div class="line">fs.file-max = 6815744</div><div class="line">kernel.shmall = 2097152</div><div class="line">kernel.shmmax = 536870912</div><div class="line">kernel.shmmni = 4096</div><div class="line">kernel.sem = 250 32000 100 128</div><div class="line">net.ipv4.ip_local_port_range = 9000 65500</div><div class="line">net.core.rmem_default = 262144</div><div class="line">net.core.rmem_max = 4194304</div><div class="line">net.core.wmem_default = 262144</div><div class="line">net.core.wmem_max = 1048586</div></pre></td></tr></table></figure>
</li>
<li><p>修改用户的限制文件/etc/security/limits.conf:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">oracle    soft    nproc    2047</div><div class="line">oracle    hard    nproc    16384</div><div class="line">oracle    soft    nofile    1024</div><div class="line">oracle    hard    nofile    65536</div><div class="line">oracle    soft    stack    10240</div></pre></td></tr></table></figure>
</li>
<li><p>单机环境通过FTP工具上传并安装依赖包packages <code>rpm -Uvh * --nodeps</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">yum -y install binutils compat-libcap1 compat-libstdc++-33  elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc-common glibc-devel glibc-headers ksh libaio libaio-devel libgcc libstdc++ libstdc++-devel libXi libXtst make sysstat unixODBC unixODBC-devel</div></pre></td></tr></table></figure>
</li>
<li><p>创建Oracle用户和相应的属组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">groupadd oinstall</div><div class="line">groupadd dba</div><div class="line">useradd -g oinstall -G dba oracle</div><div class="line">passwd oracle</div></pre></td></tr></table></figure>
</li>
<li><p>切换到oracle用户创建目录修改属组和权限</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">mkdir -p /home/oracle/oracle11g/base         #基目录</div><div class="line">mkdir -p /home/oracle/oracle11g/base/home    #家目录</div><div class="line">mkdir -p /home/oracle/oracle11g/oraInventory    #清单目录</div></pre></td></tr></table></figure>
</li>
<li><p>配置oracle用户的环境变量，编辑  ~/.bash_profile：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">export ORACLE_BASE=/home/oracle/oracle11g/base</div><div class="line">export ORACLE_HOME=$ORACLE_BASE/home </div><div class="line">export ORACLE_SID=orcl</div><div class="line">export PATH=$ORACLE_HOME/bin:$PATH:$HOME/bin </div><div class="line">export TNS_ADMIN=$ORACLE_HOME/network/admin </div><div class="line">export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME/lib</div></pre></td></tr></table></figure>
</li>
<li><p>上传oracle11g安装包并解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">unzip p13390677_112040_Linux-x86-64_1of7.zip </div><div class="line">unzip p13390677_112040_Linux-x86-64_2of7.zip</div></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h1 id="安装数据库"><a href="#安装数据库" class="headerlink" title="安装数据库"></a>安装数据库</h1><hr>
<ol>
<li><p>修改静默安装响应文件/home/oracle/database/response/db_install.rsp:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">oracle.install.option=INSTALL_DB_SWONLY </div><div class="line">ORACLE_HOSTNAME=Alien</div><div class="line">UNIX_GROUP_NAME=oinstall</div><div class="line">INVENTORY_LOCATION=/home/oracle/oracle11g/oraInventory</div><div class="line">SELECTED_LANGUAGES=en,zh_CN</div><div class="line">ORACLE_HOME=/home/oracle/oracle11g/base/home</div><div class="line">ORACLE_BASE=/home/oracle/oracle11g/base</div><div class="line">oracle.install.db.InstallEdition=EE</div><div class="line">oracle.install.db.isCustomInstall=false</div><div class="line">oracle.install.db.DBA_GROUP=dba</div><div class="line">oracle.install.db.OPER_GROUP=oinstall</div><div class="line">DECLINE_SECURITY_UPDATES=true</div></pre></td></tr></table></figure>
</li>
<li><p>启动静默安装程序<br><code>./runInstaller -silent -ignorePrereq -responseFile /home/oracle/database/response/db_install.rsp</code></p>
</li>
<li><p>配置oracle监听<br><code>./netca /silent /responsefile /home/oracle/database/response/netca.rsp</code></p>
<ul>
<li><p>若启动报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Oracle Net Services 配置:</div><div class="line"> An unexpected error has been detected by HotSpot Virtual Machine:</div><div class="line"> SIGSEGV (0xb) at pc=0x00007f2ad35f0b9d, pid=22693, tid=139822952867648</div><div class="line"> Java VM: Java HotSpot(TM) 64-Bit Server VM (1.5.0_17-b03 mixed mode)</div><div class="line"> Problematic frame:</div><div class="line"> C  [libclntsh.so.11.1+0x62ab9d]  snlinGetAddrInfo+0x1b1</div><div class="line"> An error report file with more information is saved as hs_err_pid22693.log</div><div class="line"> If you would like to submit a bug report, please visit:</div><div class="line"> http://java.sun.com/webapps/bugreport/crash.jsp</div><div class="line"> ./netca: 行 178: 22693 已放弃          $JRE $JRE_OPTIONS -classpath $CLASSPATH oracle.net.ca.NetCA $*</div></pre></td></tr></table></figure>
</li>
<li><p>尝试修改主机名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">vi /etc/sysconfig/network</div><div class="line">HOSTNAME=Alien</div><div class="line">vi /etc/hosts</div><div class="line">127.0.0.1      localhost.localdomain localhost linuxhostname Alien</div></pre></td></tr></table></figure>
</li>
<li><p>查看监听器状态：<code>lsnrctl status</code></p>
</li>
</ul>
</li>
<li><p>静默创建数据库:<br><code>./dbca -silent -responseFile /home/oracle/database/response/dbca.rsp</code><br>建库后实例检查：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ps -ef | grep ora_ | grep -v grep | wc -l</div><div class="line">ps -ef | grep ora_ | grep -v grep</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      oracle学习
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="oracle" scheme="https://aliennever.github.io/tags/oracle/"/>
    
  </entry>
  
  <entry>
    <title>Linux虚拟机安装</title>
    <link href="https://aliennever.github.io/2018/03/01/02-20180301/"/>
    <id>https://aliennever.github.io/2018/03/01/02-20180301/</id>
    <published>2018-03-01T04:00:00.000Z</published>
    <updated>2018-07-03T08:37:49.426Z</updated>
    
    <content type="html"><![CDATA[<h1 id="系统安装："><a href="#系统安装：" class="headerlink" title="系统安装："></a>系统安装：</h1><hr>
<ul>
<li>最小化安装：<ol>
<li>打开VMware，新建虚拟机&gt;典型配置&gt;稍后安装操作系统&gt;Linux&gt;选择存储文件夹&gt;设置虚拟机磁盘容量&gt;完成</li>
<li>CD/DVD选择Linux系统镜像文件&gt;开启虚拟机&gt;Install Linux&gt;安装语言选择简体中文&gt;设定时间、配置分区(规划可以如下图)、配置网络&gt;网络和主机名选择连接&gt;设置root用户密码<br><img src="http://wx4.sinaimg.cn/mw690/5a56e9c9ly1foxb7ijnx6j20m80gljsw.jpg" alt="系统分区"></li>
</ol>
</li>
</ul>
<h1 id="安装桌面环境："><a href="#安装桌面环境：" class="headerlink" title="安装桌面环境："></a>安装桌面环境：</h1><hr>
<ol>
<li>打开VMware,在CD/DVD设置选项中，将Redhat7镜像文件放入CD/DVD中</li>
<li><p>root用户下将虚拟光驱挂载到 /mnt 文件夹下 （确保虚拟光驱处于链接状态）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# mount /dev/sr0 /mnt</div><div class="line">mount: /dev/sr0 is write-protected, mounting read-only</div></pre></td></tr></table></figure>
</li>
<li><p>配置光盘为本地yum源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# vi /etc/yum.repos.d/local.repo</div><div class="line">[local]</div><div class="line">name=local</div><div class="line">baseurl=file:///mnt</div><div class="line">enabled=1</div><div class="line">gpgcheck=0</div></pre></td></tr></table></figure>
</li>
<li><p>查看组yum包\安装桌面环境组件\切换到图形化界面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[root@localhost ~]# yum grouplist</div><div class="line">[root@localhost ~]# yum groupinstall -y &quot;Server with GUI&quot;</div><div class="line">[root@localhost ~]# startx</div></pre></td></tr></table></figure>
</li>
<li><p>默认启动模式查看与切换</p>
<ul>
<li>查看当前启动模式： <code>systemctl get-default</code></li>
<li>桌面启动：<code>systemctl set-default graphical.target</code></li>
<li>命令行启动：<code>systemctl set-default multi-user.target</code></li>
</ul>
</li>
</ol>
<h1 id="安装VMware-tools"><a href="#安装VMware-tools" class="headerlink" title="安装VMware tools:"></a>安装VMware tools:</h1><hr>
<ol>
<li>虚拟机 &gt;&gt;客户机 &gt;&gt; 安装/升级 VMware Tools</li>
<li><p>挂载解压资源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[root@localhost /]# cd /media/</div><div class="line">[root@localhost media]# mount /dev/cdrom /media</div><div class="line">  mount: /dev/sr0 is write-protected, mounting read-only</div><div class="line">[root@localhost media]# cp VMwareTools-10.0.10-4301679.tar.gz /tmp</div><div class="line">[root@localhost media]# cd /tmp</div><div class="line">[root@localhost tmp]# chmod +x VMwareTools-10.0.10-4301679.tar.gz</div><div class="line">[root@localhost tmp]# tar zxf VMwareTools-10.0.10-4301679.tar.gz</div></pre></td></tr></table></figure>
</li>
<li><p>安装并卸载CD-ROM</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[root@localhost tmp]# cd vmware-tools-distrib/</div><div class="line">[root@localhost vmware-tools-distrib]# ./vmware-install.pl</div><div class="line">[root@localhost vmware-tools-distrib]# cd /</div><div class="line">[root@localhost /]# umount /media</div></pre></td></tr></table></figure></li>
</ol>
]]></content>
    
    <summary type="html">
    
      Linux学习
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="Linux" scheme="https://aliennever.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>weblogic集群配置</title>
    <link href="https://aliennever.github.io/2018/02/26/01-20180226/"/>
    <id>https://aliennever.github.io/2018/02/26/01-20180226/</id>
    <published>2018-02-26T04:00:00.000Z</published>
    <updated>2018-03-01T00:45:24.983Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一、相关概念"><a href="#一、相关概念" class="headerlink" title="一、相关概念"></a>一、相关概念</h1><hr>
<ul>
<li><p>服务器(Server):</p>
<ol>
<li>AdminServer：主要用于管理，包括应用部署，动态创建server，以及各种服务配置.所以集群环境下不会将应用、数据源等服务部署到AdminServer上面，因为AdminServer仅仅是充当管理者角色而已。运维过程中，还起到监控其它服务器状态的作用。</li>
<li>PorxyServer：主要受理各种外部请求，做负载均衡，将具体工作交给具体的服务器。所以集群环境下，也不会将应用部署到ProxyServer上。除weblogic自带负载均衡方式外，也可用Apache\Nginx软负载或者F5硬负载等方式部署。</li>
<li>Server: 实际处理业务请求的服务器，把前段代理服务器上接受到的任务进行实际处理，处理完了反馈给客户端。</li>
</ol>
<p>AdminServer只负责管理、ProxyServer负责受理分配、而普通的Server就负责处理业务请求。</p>
</li>
<li><p>集群(cluster):<br>控制台里面配置的集群，仅仅用于设置server之间的多播通信。server之间使用多播通信，互相告诉自己状态是否可用。</p>
</li>
<li><p>计算机(machine):<br>可选配置：控制台里面配置的计算机，仅仅用于配置“节点管理器”信息（地址、端口）。然后根据配置信息向节点管理器发送操作命令。</p>
</li>
<li><p>节点管理器(nodemanager):<br>可选服务：节点管理器在集群架构中，不是必须的。它的作用是用来管理server的生命周期，如果没有使用节点管理器，那么集群中的所有server的启动、关闭等常用的操作，必须通过运行startManagedWebLogic.cmd\stopManagedWebloigc.cmd脚本来完成(脚本路径：D:\Oracle\Middleware\user_projects\domains\base_domain\bin)。例如启动server1:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">startManagedWebLogic server1 127.0.0.1:7001</div><div class="line">server1 启动的受管服务器的名称   </div><div class="line">address 该域的管理服务器的IP地址   </div><div class="line">port    该域的管理服务器的监听端口</div></pre></td></tr></table></figure>
<p>所以有些集群环境下，你能看到有多少个server，就有多少个启动脚本，实际上就是执行上面这个命令。如果集群中的server分布在多台主机上面，那每次启动服务非常不方便，所以这时候，节点管理器就派上用场了，节点管理器负责管理本机server的启动、关闭等生命周期。</p>
</li>
</ul>
<hr>
<h1 id="二、单机单域集群部署实例"><a href="#二、单机单域集群部署实例" class="headerlink" title="二、单机单域集群部署实例:"></a>二、单机单域集群部署实例:</h1><hr>
<ul>
<li>部署规划：</li>
</ul>
<table>
<thead>
<tr>
<th>运行Server</th>
<th>主机Ip</th>
<th>访问port</th>
</tr>
</thead>
<tbody>
<tr>
<td>AdminServer</td>
<td>172.16.92.41</td>
<td>7001</td>
</tr>
<tr>
<td>PorxyServer</td>
<td>172.16.92.41</td>
<td>17000</td>
</tr>
<tr>
<td>Server1</td>
<td>172.16.92.41</td>
<td>17001</td>
</tr>
<tr>
<td>Server2</td>
<td>172.16.92.41</td>
<td>17002</td>
</tr>
</tbody>
</table>
<p>  其中AdminServer是总控制端，ProxyServer为负载分发代理服务器，server1、server2是集群中的两个服务节点。</p>
<ul>
<li>创建服务器\集群\计算机:<ol>
<li>登录weblogic控制台:<br>通过域目录下startWebLogic脚本启动weblogic服务，浏览器localhost:7001/console进入weblogic控制台。</li>
<li>建立服务器(Sever):<br>域结构&gt;环境&gt;服务器：分别输入ip\port建立Server1\Server2\PorxyServer</li>
<li>建立集群(cluster)<br>域结构&gt;环境&gt;集群：建立Cluster1，消息传送模式选多点传送，传送地址和端口默认。建好后点击Cluster1超链接&gt;服务器选项卡将Sever1\Sever2加入到集群中。</li>
<li>建立计算机(machine):<br>域结构&gt;环境&gt;计算机：建立Machine1,默认配置，建好后点击Machine1超链接&gt;服务器选项卡将Sever1\Sever2\PorxyServer加入到集群中。</li>
</ol>
</li>
<li><p>部署服务：<br>域结构&gt;部署：分别选择相应的项目路径部署Proxy项目和MyProject项目，MyProject项目为自建测试项目(若有数据源需要在域结构&gt;服务&gt;数据源中配置数据源)，Proxy项目为weblogic自带负载分发项目，只在WEB-INF目录下包含web.xml和weblogic.xml，相应代码如下：</p>
<ul>
<li><p>web.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</div><div class="line">  xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;</div><div class="line">  xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd&quot;</div><div class="line">  id=&quot;WebApp_ID&quot; version=&quot;2.5&quot;&gt;</div><div class="line">  &lt;display-name&gt;WeblogicProxy&lt;/display-name&gt;</div><div class="line">  &lt;!-- 配置web的servlet，拦截所有的请求，proxy内部会检测server的状态、负载情况，然后根据算法再将请求转发给具体的server处理 --&gt;</div><div class="line">  &lt;servlet&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;servlet-class&gt;weblogic.servlet.proxy.HttpClusterServlet&lt;/servlet-class&gt;</div><div class="line">    &lt;init-param&gt;</div><div class="line">      &lt;param-name&gt;WebLogicCluster&lt;/param-name&gt;</div><div class="line">      &lt;param-value&gt;172.16.92.41:17001|172.16.92.41:17002&lt;/param-value&gt;</div><div class="line">    &lt;/init-param&gt;</div><div class="line">    &lt;init-param&gt;</div><div class="line">      &lt;param-name&gt;DebugConfigInfo&lt;/param-name&gt;</div><div class="line">      &lt;param-value&gt;ON&lt;/param-value&gt;</div><div class="line">    &lt;/init-param&gt;</div><div class="line">    &lt;init-param&gt;</div><div class="line">      &lt;param-name&gt;verbose&lt;/param-name&gt;</div><div class="line">      &lt;param-value&gt;true&lt;/param-value&gt;</div><div class="line">    &lt;/init-param&gt;</div><div class="line">  &lt;/servlet&gt;</div><div class="line"></div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;/&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.jsp&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.jspx&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.htm&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.html&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.jpd&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.jcx&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.dtf&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">  &lt;servlet-mapping&gt;</div><div class="line">    &lt;servlet-name&gt;HttpClusterServlet&lt;/servlet-name&gt;</div><div class="line">    &lt;url-pattern&gt;*.jws&lt;/url-pattern&gt;</div><div class="line">  &lt;/servlet-mapping&gt;</div><div class="line">&lt;/web-app&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>weblogic.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line">&lt;wls:weblogic-web-app xmlns:wls=&quot;http://xmlns.oracle.com/weblogic/weblogic-web-app&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd http://xmlns.oracle.com/weblogic/weblogic-web-app http://xmlns.oracle.com/weblogic/weblogic-web-app/1.3/weblogic-web-app.xsd&quot;&gt;</div><div class="line">    &lt;wls:weblogic-version&gt;10.3.6&lt;/wls:weblogic-version&gt;</div><div class="line">    &lt;wls:context-root&gt;/&lt;/wls:context-root&gt;</div><div class="line">&lt;/wls:weblogic-web-app&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>启动服务器节点</p>
<ol>
<li>修改D:\Oracle\Middleware\wlserver_10.3\common\nodemanager目录下nodemanager.properties 字段，将默认的ListenAddress=localhost</li>
<li>D:\Oracle\Middleware\wlserver_10.3\server\bin目录下的脚本installNodeMgrSvc.cmd，然后在计算机&gt;管理&gt;服务启动Oracle WebLogic NodeManager (D_Oracle_Middleware_wlserver_10.3)服务</li>
<li>进入weblogic控制台界面，选择服务器&gt;控制选项卡，勾选对应的托管服务器，就可以进行启动关闭等操作。</li>
</ol>
</li>
</ul>
<hr>
<h1 id="三、双机集群部署实例："><a href="#三、双机集群部署实例：" class="headerlink" title="三、双机集群部署实例："></a>三、双机集群部署实例：</h1><hr>
<ul>
<li>前期注意：<ol>
<li>集群中的所有Server必须位于同一网段，并且必须是IP广播(UDP)可到达的;</li>
<li>集群中的所有Server必须使用相同的版本,包括 Service Pack;</li>
<li>集群中的Server必须使用永久的静态IP地址。动态IP 地址分配不能用于集群环境。如果服务器位于防火墙后面，而客户机位于防火墙外面，那么服务器必须有公共的静态IP地址，只有这样，客户端才能访问服务器;</li>
</ol>
</li>
<li>部署规划：</li>
</ul>
<table>
<thead>
<tr>
<th>运行Server</th>
<th>主机Ip</th>
<th>访问port</th>
</tr>
</thead>
<tbody>
<tr>
<td>AdminServer</td>
<td>172.16.92.41</td>
<td>7001</td>
</tr>
<tr>
<td>ProxyServer</td>
<td>172.16.92.41</td>
<td>17000</td>
</tr>
<tr>
<td>Server1</td>
<td>172.16.92.41</td>
<td>17001</td>
</tr>
<tr>
<td>Server2</td>
<td>172.16.92.42</td>
<td>17001</td>
</tr>
</tbody>
</table>
<ul>
<li>创建域：<ul>
<li>172.16.92.41:</li>
</ul>
<ol>
<li>启动weblogic配置向导，创建weblogic域，选择可选配置选项卡选择’管理服务器’和’受管理服务器，集群和计算机’两个选项，依照上述规划进行建立。</li>
<li>启动weblogic控制台，登录管理服务，安装部署应用及代理服务.配置Jndi数据源。<br>以上步骤注意地址一定输入准确的IP地址不要使用localhost！<br>管理服务AdminServer监听地址为空！<br>若本机有虚拟网卡需要禁用！</li>
</ol>
<ul>
<li>172.16.92.42：<br>启动weblogic配置向导，创建weblogic域，选择可选配置选项卡选择’管理服务器’和’受管理服务器，集群和计算机’两个选项，管理服务器IP选择172.16.92.41服务器名建立要与172.16.92.41上建立的相匹配(即Server2)，集群和计算机不用配置。</li>
</ul>
</li>
<li>部署服务：<br>分别选择相应的项目路径部署Proxy项目和MyProject项目，程序中调用Jndi时也需要使用准确的IP地址！</li>
</ul>
]]></content>
    
    <summary type="html">
    
      weblgoic学习
    
    </summary>
    
      <category term="学习笔记" scheme="https://aliennever.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="weblogic" scheme="https://aliennever.github.io/tags/weblogic/"/>
    
  </entry>
  
</feed>
